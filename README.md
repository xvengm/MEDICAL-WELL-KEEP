# 🩺 Medical Record Summarizer (RAG + FastAPI + Gemini)

A web application that allows patients and healthcare workers to **upload medical documents** (PDF, DOCX, TXT, or scanned images like JPEG/PNG) and get a **clear, plain-language summary** generated by Google Gemini 1.5 models.  

The app combines:
- **Document parsing & OCR** (PyMuPDF, python-docx, Tesseract, or Gemini Vision)
- **Retrieval-Augmented Generation (RAG)** with trusted medical sources
- **FastAPI backend** with a clean JSON API
- **Frontend widget** built with HTML + Tailwind (drag & drop uploads, friendly UI)

---

## 🚀 Features
- **File Upload Support**
  - PDF  
  - DOC / DOCX  
  - TXT  
  - Images (JPEG, PNG — scanned reports, prescriptions, test results)

- **Medical Summarization**
  - Converts complex reports into simple plain-English summaries.
  - Structured format:  
    - **Main Issue**  
    - **Key Findings**  
    - **Treatment / Plan**  
    - **Important Notes**

- **Contextual Knowledge**
  - Uses trusted sources (WHO, NIH, Mayo Clinic, FDA, NICE, MedlinePlus) stored in a **ChromaDB vector store** for retrieval.

- **Interactive Follow-up**
  - After uploading, users can **ask follow-up questions** (e.g., *“What does rigors mean?”*).

- **Confidence & Disclaimer**
  - Every summary includes a **confidence score (High/Medium/Low)** and a clear disclaimer.

---

## 🛠️ Tech Stack
- **Backend**: [FastAPI](https://fastapi.tiangolo.com/)  
- **Frontend**: HTML + Tailwind + Vanilla JS  
- **LLM**: [Google Gemini 1.5 Flash](https://ai.google.dev/) via `langchain-google-genai`  
- **Vector DB**: [ChromaDB](https://www.trychroma.com/)  
- **Parsing Libraries**:
  - [PyMuPDF](https://pymupdf.readthedocs.io/en/latest/) → PDF  
  - [python-docx](https://python-docx.readthedocs.io/) → DOCX  
  - [Textract](https://textract.readthedocs.io/) (optional) → legacy DOC  
  - [Pytesseract](https://pypi.org/project/pytesseract/) → OCR (scanned images)  
  - **Gemini Multimodal Fallback** → image text extraction when OCR is unavailable  

---

## 📂 Project Structure
```
medical-rag-app/
│
├── main.py                # FastAPI backend (API routes)
├── rag_agent.py           # RAG pipeline & document parsing
├── templates/
│   └── home.html          # Frontend UI (upload + summarize + ask)
├── requirements.txt       # Python dependencies
└── README.md              # Documentation
```

---

## ⚙️ Installation

### 1. Clone repo
```bash
git clone https://github.com/MAYOR-G/MEDICAL-RAG.git
cd MEDICAL-RAG
```

### 2. Create virtual environment
```bash
python -m venv venv
# Activate
# On Windows
venv\Scripts\activate
# On macOS/Linux
source venv/bin/activate
```

### 3. Install dependencies
```bash
pip install --upgrade pip
pip install -r requirements.txt
```

### 4. System dependencies
- **Tesseract OCR** (for scanned image parsing)
  - Windows: [Installer](https://github.com/UB-Mannheim/tesseract/wiki)
  - macOS: `brew install tesseract`
  - Ubuntu/Debian: `sudo apt install tesseract-ocr`
- (Optional) `antiword` / `catdoc` if you want **legacy .doc** support (Linux only). Otherwise, ask users to convert `.doc` → `.docx`.

---

## 🔑 Environment Variables
Create a `.env` file in the project root:

```env
GOOGLE_API_KEY=your_gemini_api_key_here
```

Get your API key from [Google AI Studio](https://aistudio.google.com/app/apikey).

---

## ▶️ Run the App
```bash
uvicorn main:app --reload --port 8000
```

Open your browser: [http://127.0.0.1:8000](http://127.0.0.1:8000)

---

## 🌐 Usage
1. **Upload a document** (PDF, DOCX, TXT, JPG, PNG).  
2. Get an instant **structured summary** in plain English.  
3. **Ask follow-up questions** in natural language (e.g., *“What is an ECG?”*).  

---

## 📊 Example Output
**Upload:** `medical_report_malaria.pdf`  
**Summary Returned:**
```json
{
  "summary": "Based on your uploaded record, the patient has malaria infection confirmed by blood smear.",
  "confidence": "High",
  "main_issue": "Severe malaria due to Plasmodium falciparum",
  "key_findings": "Fever (39.5°C), chills, mild jaundice, splenomegaly, high parasitemia",
  "treatment_plan": "IV Artesunate followed by ACT, IV fluids, antipyretics",
  "important_notes": "Close monitoring for renal failure and cerebral malaria",
  "codes": ["B50.0"],
  "follow_up_questions": ["What are the side effects of Artesunate?"],
  "disclaimer": "This summary is for informational purposes only. Always seek advice from your doctor or qualified health practitioner."
}
```

---

## 🧠 How it Works
1. **Parsing** → Text is extracted from the uploaded file (OCR/Gemini Vision if needed).  
2. **Chunking** → Long documents are split into manageable text chunks.  
3. **Retrieval** → Similarity search against trusted medical sources in ChromaDB.  
4. **LLM Summarization** → Gemini 1.5 Flash generates a structured JSON summary.  
5. **Frontend Rendering** → Results shown in styled cards, not raw JSON.  

---

## 🛡️ Error Handling
- Unsupported file types → `415 Unsupported file type`  
- Empty uploads → `400 Empty file uploaded`  
- Expired session IDs → instructs users to re-upload  
- Image parsing failures → instructs users to install Tesseract or ensure Gemini Vision API access  

---

## 🧩 Roadmap
- [ ] Add multilingual summaries (French, Spanish, Swahili)  
- [ ] Deploy on **Docker** with GPU support  
- [ ] Add **Redis** session storage (so follow-ups survive server restarts)  
- [ ] HIPAA/GDPR compliance (encryption + audit logging)  

---

## 🤝 Contributing
1. Fork repo  
2. Create feature branch  
3. Submit PR with clear description  

---

## 📜 License
MIT License © 2025 Your Name / Vendgram
